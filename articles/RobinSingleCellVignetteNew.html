<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RobinSingleCellVignette â€¢ scrobinv2</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="RobinSingleCellVignette">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scrobinv2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/HOWTO_BUILD_WORKSHOP.html">How to Use this Package to Build a Bioc Workshop</a>
    </li>
    <li>
      <a href="../articles/RobinSingleCellVignetteNew.html">RobinSingleCellVignette</a>
    </li>
    <li>
      <a href="../articles/workshop_example.html">An Example Workshop</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/drighelli/scrobinv2" class="external-link">
    <span class="fa fa-github"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>RobinSingleCellVignette</h1>
                        <h4 data-toc-skip class="author">Valeria
Policastro</h4>
            
            <h4 data-toc-skip class="date">26/11/2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/drighelli/scrobinv2/blob/devel/vignettes/RobinSingleCellVignetteNew.Rmd" class="external-link"><code>vignettes/RobinSingleCellVignetteNew.Rmd</code></a></small>
      <div class="hidden name"><code>RobinSingleCellVignetteNew.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="single-cell-rnaseq-analysis">Single cell RNAseq Analysis<a class="anchor" aria-label="anchor" href="#single-cell-rnaseq-analysis"></a>
</h2>
<div class="section level3">
<h3 id="package-loading">Package loading<a class="anchor" aria-label="anchor" href="#package-loading"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mclust-org.github.io/mclust/" class="external-link">mclust</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="reading-data">Reading data<a class="anchor" aria-label="anchor" href="#reading-data"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datav2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Subsemple1percentemptyDroplets_doublet_filtered_tabulamuris_mtx.rds"</span>, package <span class="op">=</span> <span class="st">"scrobinv2"</span><span class="op">)</span></span>
<span><span class="va">tabData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="va">datav2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">SingleCellData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/CreateSeuratObject.html" class="external-link">CreateSeuratObject</a></span><span class="op">(</span>counts <span class="op">=</span> <span class="va">tabData</span>, project <span class="op">=</span> <span class="st">"singleCell"</span>, min.cells <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">tabData</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="fl">5</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span>, min.features <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">SingleCellData</span> </span></code></pre></div>
<pre><code><span><span class="co">## An object of class Seurat </span></span>
<span><span class="co">## 8694 features across 532 samples within 1 assay </span></span>
<span><span class="co">## Active assay: RNA (8694 features, 0 variable features)</span></span>
<span><span class="co">##  1 layer present: counts</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="data-normalization">Data normalization<a class="anchor" aria-label="anchor" href="#data-normalization"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SingleCellData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/NormalizeData.html" class="external-link">NormalizeData</a></span><span class="op">(</span><span class="va">SingleCellData</span>, normalization.method <span class="op">=</span> <span class="st">"LogNormalize"</span>, scale.factor <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span>
<span></span>
<span><span class="va">SingleCellData</span><span class="op">[[</span><span class="st">"RNA"</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">layers</span><span class="op">$</span><span class="va">counts</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## 5 x 5 sparse Matrix of class "dgCMatrix"</span></span>
<span><span class="co">##               </span></span>
<span><span class="co">## [1,] . . . . .</span></span>
<span><span class="co">## [2,] . . 1 . 1</span></span>
<span><span class="co">## [3,] . . 1 . 1</span></span>
<span><span class="co">## [4,] 1 . 1 . .</span></span>
<span><span class="co">## [5,] 1 1 2 . .</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="feature-selection">Feature selection<a class="anchor" aria-label="anchor" href="#feature-selection"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SingleCellData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/FindVariableFeatures.html" class="external-link">FindVariableFeatures</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">SingleCellData</span>, selection.method<span class="op">=</span><span class="st">"vst"</span>, nfeatures <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="scale-the-data">Scale the data<a class="anchor" aria-label="anchor" href="#scale-the-data"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SingleCellData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/ScaleData.html" class="external-link">ScaleData</a></span><span class="op">(</span><span class="va">SingleCellData</span>, do.center <span class="op">=</span> <span class="cn">TRUE</span>, do.scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">SingleCellData</span><span class="op">[[</span><span class="st">"RNA"</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">layers</span><span class="op">$</span><span class="va">scale.data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##            [,1]       [,2]       [,3]       [,4]       [,5]</span></span>
<span><span class="co">## [1,] -0.2119967 -0.2119967 -0.2119967 -0.2119967 -0.2119967</span></span>
<span><span class="co">## [2,] -0.2464207 -0.2464207 -0.2464207  6.4241312 -0.2464207</span></span>
<span><span class="co">## [3,] -0.2325839 -0.2325839 -0.2325839 -0.2325839 -0.2325839</span></span>
<span><span class="co">## [4,] -0.3036820 -0.3036820 -0.3036820 -0.3036820 -0.3036820</span></span>
<span><span class="co">## [5,] -0.2199427 -0.2199427 -0.2199427 -0.2199427 -0.2199427</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="linear-dimension-reduction">Linear dimension reduction<a class="anchor" aria-label="anchor" href="#linear-dimension-reduction"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SingleCellData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/RunPCA.html" class="external-link">RunPCA</a></span><span class="op">(</span><span class="va">SingleCellData</span>, features <span class="op">=</span> <span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/VariableFeatures.html" class="external-link">VariableFeatures</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">SingleCellData</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="graph">Graph<a class="anchor" aria-label="anchor" href="#graph"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SingleCellData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/FindNeighbors.html" class="external-link">FindNeighbors</a></span><span class="op">(</span><span class="va">SingleCellData</span>, dims <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">SingleCellData</span><span class="op">@</span><span class="va">graphs</span><span class="op">$</span><span class="va">RNA_snn</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> <span class="co"># Adjacency matrix</span></span></code></pre></div>
<pre><code><span><span class="co">## 5 x 5 sparse Matrix of class "dgCMatrix"</span></span>
<span><span class="co">##                            10X_P4_7_CCTACACGTAAGGATT 10X_P7_6_ACACCGGGTAGCGTGA</span></span>
<span><span class="co">## 10X_P4_7_CCTACACGTAAGGATT                  1.0000000                 0.1428571</span></span>
<span><span class="co">## 10X_P7_6_ACACCGGGTAGCGTGA                  0.1428571                 1.0000000</span></span>
<span><span class="co">## 10X_P7_9_TGATTTCAGCAGGTCA                  .                         .        </span></span>
<span><span class="co">## 10X_P8_14_CGAATGTAGAAGGTGA                 .                         .        </span></span>
<span><span class="co">## 10X_P4_6_CGATGGCCATCACAAC                  .                         .        </span></span>
<span><span class="co">##                            10X_P7_9_TGATTTCAGCAGGTCA 10X_P8_14_CGAATGTAGAAGGTGA</span></span>
<span><span class="co">## 10X_P4_7_CCTACACGTAAGGATT                  .                                  .</span></span>
<span><span class="co">## 10X_P7_6_ACACCGGGTAGCGTGA                  .                                  .</span></span>
<span><span class="co">## 10X_P7_9_TGATTTCAGCAGGTCA                  1.0000000                          .</span></span>
<span><span class="co">## 10X_P8_14_CGAATGTAGAAGGTGA                 .                                  1</span></span>
<span><span class="co">## 10X_P4_6_CGATGGCCATCACAAC                  0.2121212                          .</span></span>
<span><span class="co">##                            10X_P4_6_CGATGGCCATCACAAC</span></span>
<span><span class="co">## 10X_P4_7_CCTACACGTAAGGATT                  .        </span></span>
<span><span class="co">## 10X_P7_6_ACACCGGGTAGCGTGA                  .        </span></span>
<span><span class="co">## 10X_P7_9_TGATTTCAGCAGGTCA                  0.2121212</span></span>
<span><span class="co">## 10X_P8_14_CGAATGTAGAAGGTGA                 .        </span></span>
<span><span class="co">## 10X_P4_6_CGATGGCCATCACAAC                  1.0000000</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="how-to-use-robin">How to use Robin<a class="anchor" aria-label="anchor" href="#how-to-use-robin"></a>
</h2>
<div class="section level3">
<h3 id="reading-graph">Reading Graph<a class="anchor" aria-label="anchor" href="#reading-graph"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ValeriaPolicastro/robin" class="external-link">robin</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">AdjSNN</span> <span class="op">&lt;-</span> <span class="va">SingleCellData</span><span class="op">@</span><span class="va">graphs</span><span class="op">$</span><span class="va">RNA_snn</span></span>
<span><span class="va">graphSingleCell</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/graph_from_adjacency_matrix.html" class="external-link">graph_from_adjacency_matrix</a></span><span class="op">(</span><span class="va">AdjSNN</span>,mode<span class="op">=</span><span class="st">"directed"</span>,weighted <span class="op">=</span> <span class="cn">TRUE</span>,add.colnames <span class="op">=</span> <span class="st">"NA"</span>,diag<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">edge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r.igraph.org/reference/as_edgelist.html" class="external-link">as_edgelist</a></span><span class="op">(</span><span class="va">graphSingleCell</span><span class="op">)</span></span>
<span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/graph_from_edgelist.html" class="external-link">graph_from_edgelist</a></span><span class="op">(</span><span class="va">edge</span>, directed<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/simplify.html" class="external-link">simplify</a></span><span class="op">(</span><span class="va">graph</span><span class="op">)</span></span>
<span><span class="va">graph</span></span></code></pre></div>
<pre><code><span><span class="co">## IGRAPH b99442e U--- 532 14421 -- </span></span>
<span><span class="co">## + edges from b99442e:</span></span>
<span><span class="co">##  [1] 1--  2 1--  8 1-- 13 1-- 14 1-- 17 1-- 27 1-- 42 1-- 63 1-- 65 1-- 71</span></span>
<span><span class="co">## [11] 1-- 79 1-- 95 1-- 99 1--102 1--116 1--131 1--132 1--159 1--161 1--164</span></span>
<span><span class="co">## [21] 1--172 1--179 1--194 1--197 1--205 1--220 1--258 1--260 1--264 1--267</span></span>
<span><span class="co">## [31] 1--270 1--312 1--315 1--325 1--327 1--328 1--351 1--368 1--378 1--386</span></span>
<span><span class="co">## [41] 1--391 1--393 1--395 1--397 1--406 1--407 1--409 1--420 1--421 1--426</span></span>
<span><span class="co">## [51] 1--427 1--432 1--452 1--458 1--459 1--464 1--472 1--473 1--476 1--478</span></span>
<span><span class="co">## [61] 1--495 1--496 1--497 1--501 1--502 1--503 1--510 1--518 2--  8 2-- 13</span></span>
<span><span class="co">## [71] 2-- 14 2-- 27 2-- 42 2-- 63 2-- 65 2-- 71 2-- 79 2-- 95 2-- 99 2--102</span></span>
<span><span class="co">## [81] 2--116 2--131 2--132 2--159 2--161 2--164 2--172 2--179 2--194 2--197</span></span>
<span><span class="co">## + ... omitted several edges</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="compare-all-algorithms-vs-louvain">Compare all algorithms vs Louvain<a class="anchor" aria-label="anchor" href="#compare-all-algorithms-vs-louvain"></a>
</h3>
<p>We apply the compare procedure to see which is the algorithm that
better fits our network.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Infomap</span></span>
<span> <span class="va">comp_I</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/robin/man/robinCompare.html" class="external-link">robinCompare</a></span><span class="op">(</span>graph<span class="op">=</span><span class="va">graph</span>, method1<span class="op">=</span><span class="st">"louvain"</span>,</span>
<span>                        method2<span class="op">=</span><span class="st">"infomap"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Unweighted Network Parallel Function"</span></span>
<span><span class="co">## Detected robin method type independent</span></span>
<span><span class="co">## It can take time ... It depends on the size of the network.</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">plot1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">comp_I</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#Walktrap</span></span>
<span><span class="va">comp_W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/robin/man/robinCompare.html" class="external-link">robinCompare</a></span><span class="op">(</span>graph<span class="op">=</span><span class="va">graph</span>, method1<span class="op">=</span><span class="st">"louvain"</span>,</span>
<span>                       method2<span class="op">=</span><span class="st">"walktrap"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Unweighted Network Parallel Function"</span></span>
<span><span class="co">## Detected robin method type independent</span></span>
<span><span class="co">## It can take time ... It depends on the size of the network.</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">comp_W</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#LabelProp</span></span>
<span><span class="va">comp_La</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/robin/man/robinCompare.html" class="external-link">robinCompare</a></span><span class="op">(</span>graph<span class="op">=</span><span class="va">graph</span>, method1<span class="op">=</span><span class="st">"louvain"</span>,</span>
<span>                        method2<span class="op">=</span><span class="st">"labelProp"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Unweighted Network Parallel Function"</span></span>
<span><span class="co">## Detected robin method type independent</span></span>
<span><span class="co">## It can take time ... It depends on the size of the network.</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">comp_La</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Fastgreedy</span></span>
<span><span class="va">comp_F</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/robin/man/robinCompare.html" class="external-link">robinCompare</a></span><span class="op">(</span>graph<span class="op">=</span><span class="va">graph</span>, method1<span class="op">=</span><span class="st">"louvain"</span>,</span>
<span>                        method2<span class="op">=</span><span class="st">"fastGreedy"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Unweighted Network Parallel Function"</span></span>
<span><span class="co">## Detected robin method type independent</span></span>
<span><span class="co">## It can take time ... It depends on the size of the network.</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">comp_F</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">PlotComparisonAllVsInfomap</span> <span class="op">&lt;-</span> <span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">plot1</span>,<span class="va">plot2</span>,<span class="va">plot3</span>,<span class="va">plot4</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="RobinSingleCellVignetteNew_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>The lowest curve is the most stable algorithm. Louvain and Walktrap
are the best algorithms in our example.</p>
</div>
<div class="section level3">
<h3 id="statistical-significance-of-communities">Statistical significance of communities<a class="anchor" aria-label="anchor" href="#statistical-significance-of-communities"></a>
</h3>
<p>Due to the fact that Louvain is one of the best algorithm for our
network we apply the robust procedure with the Louvain algorithm to see
if the communities detected are statistically significant.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graphRandom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/robin/man/random.html" class="external-link">random</a></span><span class="op">(</span>graph<span class="op">=</span><span class="va">graph</span><span class="op">)</span></span>
<span><span class="va">proc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/robin/man/robinRobust.html" class="external-link">robinRobust</a></span><span class="op">(</span>graph<span class="op">=</span><span class="va">graph</span>, graphRandom<span class="op">=</span><span class="va">graphRandom</span>, method<span class="op">=</span><span class="st">"louvain"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Unweighted Network Parallel Function"</span></span>
<span><span class="co">## Detected robin method type independent</span></span>
<span><span class="co">## It can take time ... It depends on the size of the network.</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">proc</span><span class="op">)</span></span></code></pre></div>
<p><img src="RobinSingleCellVignetteNew_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/robin/man/robinFDATest.html" class="external-link">robinFDATest</a></span><span class="op">(</span><span class="va">proc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "First step: basis expansion"</span></span>
<span><span class="co">## Swapping 'y' and 'argvals', because 'y' is  simpler,</span></span>
<span><span class="co">##   and 'argvals' should be;  now  dim(argvals) =  13 ;  dim(y) =  13 x 20 </span></span>
<span><span class="co">## [1] "Second step: joint univariate tests"</span></span>
<span><span class="co">## [1] "Third step: interval-wise combination and correction"</span></span>
<span><span class="co">## [1] "creating the p-value matrix: end of row 2 out of 9"</span></span>
<span><span class="co">## [1] "creating the p-value matrix: end of row 3 out of 9"</span></span>
<span><span class="co">## [1] "creating the p-value matrix: end of row 4 out of 9"</span></span>
<span><span class="co">## [1] "creating the p-value matrix: end of row 5 out of 9"</span></span>
<span><span class="co">## [1] "creating the p-value matrix: end of row 6 out of 9"</span></span>
<span><span class="co">## [1] "creating the p-value matrix: end of row 7 out of 9"</span></span>
<span><span class="co">## [1] "creating the p-value matrix: end of row 8 out of 9"</span></span>
<span><span class="co">## [1] "creating the p-value matrix: end of row 9 out of 9"</span></span>
<span><span class="co">## [1] "Interval Testing Procedure completed"</span></span></code></pre>
<p><img src="RobinSingleCellVignetteNew_files/figure-html/unnamed-chunk-11-2.png" width="700"></p>
<pre><code><span><span class="co">## TableGrob (1 x 2) "arrange": 2 grobs</span></span>
<span><span class="co">##   z     cells    name           grob</span></span>
<span><span class="co">## 1 1 (1-1,1-1) arrange gtable[layout]</span></span>
<span><span class="co">## 2 2 (1-1,2-2) arrange gtable[layout]</span></span></code></pre>
<pre><code><span><span class="co">## $adj.pvalue</span></span>
<span><span class="co">## [1] 0.2969 0.0071 0.0017 0.0017 0.0017 0.0017 0.0017 0.0028 0.0072</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $pvalues</span></span>
<span><span class="co">## [1] 0.2969 0.0017 0.0017 0.0017 0.0017 0.0017 0.0017 0.0017 0.0017</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/robin/man/robinGPTest.html" class="external-link">robinGPTest</a></span><span class="op">(</span><span class="va">proc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  Profile  1 </span></span>
<span><span class="co">##  Profile  2</span></span></code></pre>
<pre><code><span><span class="co">## [1] 86.14652</span></span></code></pre>
<p>The communities given by Louvain are statistically significant.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Dario Righelli.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
